<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My App</title>
    <style>
        html, body { height: 100%; width: 100%; margin: 0; padding: 0; overflow: hidden; }
        iframe { width: 100%; height: 100%; border: none; display: block; }
    </style>
</head>
<body>
    <div id="iframe-container" style="width:100%; height:100%;"></div>

    <script>
        // Your stable, existing deployment URL
        const appScriptUrl = "https://script.google.com/macros/s/AKfycbz4vY3Wwgbfn89hR1TTToV1XKCn_MGri3UkpKTLrX34F0BBuSKrgEdEcLK2YVBwXFJd/exec";
        
        const iframe = document.createElement('iframe');
        
        // Construct the URL with BOTH the origin and the cache buster
        const urlWithParams = appScriptUrl + 
            "?origin=" + encodeURIComponent(window.location.origin) +
            "&cacheBuster=" + Date.now(); // <-- THE CACHE-BUSTING PARAMETER
            
        iframe.src = urlWithParams;
        console.log("Parent: Loading iframe with URL:", urlWithParams); // For debugging
        
        document.getElementById('iframe-container').appendChild(iframe);

        function sendViewportHeight() {
            const height = window.visualViewport.height;
            console.log("Parent: Sending height ->", height);
            iframe.contentWindow.postMessage({ height: height }, '*');
        }

        iframe.onload = () => {
            console.log("Parent: iframe loaded. Sending initial height.");
            sendViewportHeight();
        };

        window.visualViewport.addEventListener('resize', sendViewportHeight);
    </script>
</body>
</html>
